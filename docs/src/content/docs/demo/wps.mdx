---
title: WPS 用法示例
description: WPS 用法示例
---

金山文档（WPS 云文档）使用详细教程

:::caution[警告]
可能随着金山文档的更新，部分步骤有所变动，但是这并不影响整体思路，不要因为一个步骤对不上就不知道怎么做，我不是 10086，你吃奶的问题，请自行解决。

目前请不要使用 2.0 的AirScript
:::

## 创建账号

官网 https://www.kdocs.cn/

如果你未曾拥有金山文档账号，请先注册一个账号，然后登录。详细步骤略。

## 创建文档

点击首页的 `+新建`

![创建文档](@imgs/wps/create_docs.png)

然后选择 `智能表格` 或者 `表格`（这里以表格为例）

然后创建一个空白表格

![创建一个空白表格](@imgs/wps/create_table.png)

## 表格介绍

![表格介绍](@imgs/wps/table_info.png)

字母 ABCD。。。 表示表格的列

数字 1234。。。 表示表格的行

`A1` 表示第一行第一列（左上角那个格子），那么 `B2` 呢？

最底部有个 `Sheet1` （中文叫做 工作表），新建的表格只有一个工作表，你可以点击后面的 `+` 添加（选择工具表）

鼠标左键双击 `Sheet1` 这个 sheet，然后就能输入你想要的名称了，比如 `夸克网盘`。

鼠标左键单击 `Sheet1` 这个 sheet，就是选中这个工作表（有多个工作表时有效，例如图中 `Sheet2` 绿色加粗的，所以我当前选择的是 `Sheet2`）。

**动手试下：**

试试让自己拥有 `alipan`，`quark` 以及 `推送` 三个工作表吧。成功后进入下一章节。

## 运行简单的脚本

**以阿里云盘签到为例**

![表格介绍](@imgs/wps/alpan_token.png)

选择 `alipan` sheet，在 `A1` 填上你的 token（如何获取不在本教程范围内，请自行完成）。每一行表示一个用户，故 `A2` 可以是你的第二个账号，`A3` 呢？以此类推。。。

### 创建脚本

![创建脚本](@imgs/wps/create_air.png)

1. 点击头部菜单栏的 `效率`
2. 选择`高级开发`
3. 选择 `AirScript 脚本编辑器`
4. 点击文档共享脚本后面的 `+` 加号

![创建脚本](@imgs/wps/create_air2.png)

5. 粘贴脚本代码（示例代码：https://www.npmjs.com/package/@asunajs/dist?activeTab=code 点击后选择 `alipan.wps.js`）
6. 点击输入框上面的操作栏的第六个，一个六边形图标那个（鼠标放上去显示服务授权）
7. 点击添加服务
8. 添加 `网络API`，`邮箱API`

![运行](@imgs/wps/create_air3.png)

9. 点击输入框上面的操作栏的第四个，一个三角形图标那个（鼠标放上去显示运行 F5）
10. 允许服务授权

![成功](@imgs/wps/create_air4.png)

当看到成功提示时，恭喜你，你已经成功运行了脚本。

## 推送

### 表格设计

点击刚才创建的 `推送` 工作表

推送配置设计如下：

表格如图所示，每两列为一个配置单元（每个单元之间允许空列，可有可没有，例如 C 列就是空的，但是 EF 之间没有空）

单元的第首行首列放置推送名，如 email，pushplus。base 比较特殊。（如果没有放推送名，下面写的东西就会被忽略掉）

除第一行外，每个单元第一列为配置名称，第二列为值，中间允许空行（如 email 的第 4 行所示）

![推送](@imgs/wps/create_push.png)

注意：图中表格的颜色是为了方便演示添加的，无实际意义，你不必和我的一样。

### 支持的推送

[推送](/reference/push/)

看看 email pushplus 的配置，和这里有啥关系？看不懂？那你别用推送了，孺子不可教也。

### 测试

再次回到 `alipan` 工作表（一定要点回来哦），还记得刚才怎么运行的脚本吗？

再次运行，就能看到类似 `邮件消息已发送` 的推送提示了。

## 定时运行

这里就不放图了

1. 点击头部菜单栏的 `效率`
2. 选择 `高级开发`
3. 选择 `定时任务`
4. 右边出来的抽屉中点击蓝色的 `创建任务`
5. 选择每天，再选个具体时间（不推荐晚上接近 12 点，也不推荐凌晨）
6. 选择你创建的脚本
7. 然后点击确定

恭喜你，你已经成功设置了定时任务。

## 新增脚本

刚才举例了 `alipan` ，但还记得最初让你创建了三个工作表吗？现在我们就来补齐 `quark` 工作表

鼠标左键单击 `quark` 工作表

同样在 `A1` 填上你的 infoUrl，`A2` 填上你的 signUrl （如何获取不在本教程范围内，请自行完成）。每一行表示一个用户，故 `A2` 可以是你的第二个账号，`A3` 呢？以此类推。。。

### 创建脚本

1. 点击头部菜单栏的 `效率`
2. 选择`高级开发`
3. 选择 `AirScript 脚本编辑器`
4. 点击文档共享脚本后面的 `+` 加号
5. 给脚本命名（如夸克网盘）
6. 粘贴脚本代码（示例代码：https://www.npmjs.com/package/@asunajs/dist?activeTab=code 点击后选择 `quark.wps.js`）
7. 点击输入框上面的操作栏的第六个，一个六边形图标那个（鼠标放上去显示服务授权）
8. 点击添加服务
9. 添加 `网络API`，`邮箱API`
10. 点击输入框上面的操作栏的第四个，一个三角形图标那个（鼠标放上去显示运行 F5）

得到类似

```bash
21:41:28.225 通知  脚本环境初始化...               <system>
21:41:28.267 通知  已开始执行                     <system>
21:41:28.286 信息  执行第 1 行                    夸克.js:290:37
21:41:28.287 信息  --------------                夸克.js:70:26
21:41:28.287 信息  今日已签到+20MB，连签进度1/7。    夸克.js:70:26
21:41:28.287 信息  邮件消息已发送                  夸克.js:70:26
21:41:28.267 通知  执行完毕                       <system>
```

发现没有，推送也生效了。

### 自动运行

略，还记得创建定时任务吗？
